package hellorest.src;

import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;

import javax.crypto.BadPaddingException;
import javax.crypto.IllegalBlockSizeException;
import javax.crypto.NoSuchPaddingException;
import javax.jws.WebMethod;
import javax.jws.WebService;

@WebService
public class Hello2
{
    private final String message = new String("Hello, ");
	private final static byte[] PrivateKey = {48,-126,2,117,2,1,0,48,13,6,9,42,-122,72,-122,-9,13,1,1,1,5,0,4,-126,2,95,48,-126,2,91,2,1,0,2,-127,-127,0,-93,111,-117,28,14,19,59,-86,120,51,-55,66,1,-101,-94,59,46,35,90,59,-72,37,-19,-90,-89,-3,27,76,15,116,70,-67,-27,114,-99,127,70,37,-77,107,-42,58,87,56,58,-118,-67,-71,-115,-69,-13,70,-37,-79,-29,-62,-55,91,-76,-77,-109,91,71,14,54,-23,-98,77,56,69,90,-34,-117,33,40,47,43,22,-70,82,99,43,26,-8,65,12,-1,-113,-80,-27,19,48,-72,-123,-125,-101,-104,-37,-54,-95,99,11,-84,64,19,-117,-71,39,-20,28,12,23,-68,113,-35,114,-14,1,-105,109,-73,40,104,12,-58,49,104,65,2,3,1,0,1,2,-127,-128,46,119,-125,60,-103,-65,-36,33,-18,-123,2,-66,-110,-120,118,74,-113,38,-101,-4,8,-78,55,-20,63,44,-42,58,-4,-43,-39,91,26,70,73,3,43,-91,-126,106,-79,-128,-22,-43,96,-57,-101,-125,-117,9,-103,-12,86,120,48,66,108,79,119,-125,-22,-20,115,-71,-32,-8,-127,-17,-60,77,-35,-22,-60,101,112,-102,-56,48,-124,109,34,40,-80,-42,-83,19,-102,-116,-15,105,5,-73,30,-10,-115,79,33,49,84,-111,-91,-52,94,-122,102,22,126,-2,-93,118,69,-127,41,-19,49,88,72,-97,-15,-30,-28,-126,94,-97,23,59,-43,49,2,65,0,-30,81,-115,-52,-55,10,-59,27,-108,-44,55,-73,101,-86,-20,-59,68,-60,-4,118,-32,-28,-2,-128,105,-115,91,22,97,-53,74,123,-27,-18,119,32,-52,29,84,-15,55,46,-96,-59,-48,-112,-83,-64,-54,98,116,82,-82,109,-56,44,98,-53,-118,126,97,-57,-110,61,2,65,0,-72,-34,-64,-45,57,8,-124,77,-29,33,-73,89,-4,-38,-89,-83,108,-53,-30,107,93,-26,50,-6,-36,-21,-102,-49,41,-68,-118,-110,-56,-64,-118,68,58,-109,-88,-91,-127,49,82,74,-94,-113,55,70,3,90,79,-13,19,-100,117,75,69,108,-66,-5,0,100,-30,85,2,64,73,65,54,-111,-53,-99,53,-47,-56,-87,-84,99,43,-128,88,-27,61,110,57,125,-51,43,-78,9,36,-95,65,-109,-116,17,-2,72,-2,82,-30,-78,117,-1,36,-120,115,97,31,95,8,52,92,89,99,-24,-36,88,10,-25,-77,-4,81,-6,42,24,-32,83,117,-51,2,64,20,12,-12,-44,-13,-26,-100,-110,-26,3,-114,35,80,109,86,-86,84,-106,120,100,52,-74,-10,-24,-122,117,119,64,-24,-63,-18,53,-91,88,92,-90,-79,-61,-70,18,-39,68,68,44,-100,28,-12,93,-65,-105,87,-4,-127,48,2,-8,-70,-6,-28,107,-52,-53,36,81,2,64,30,-81,37,-23,17,24,92,-81,-20,-117,9,59,53,116,-119,13,-72,75,-120,-92,36,28,-57,42,-32,36,101,25,-107,-41,119,121,124,88,-51,14,63,-10,-112,31,-124,-109,52,86,-81,3,99,43,-22,-123,-52,-76,-70,-67,-87,17,49,68,113,-91,22,-85,23,-48};

    public Hello2()
    {}

    @WebMethod(operationName="sendImage")
    public DummyClass sayHello(String pacientName, String pacientId,
    		long longitud, long latitud,
    		byte[] byteArray, String disease,
    		long key){
    	
    	String nuevoTexto = "";
    	try{
    	System.out.println("pacientName: " +  pacientName
    			 + "\n pacientId: " +   pacientId
    			 + "\n longitud: " + longitud
    			 + "\n latitud: " + latitud
    			 + "\n disease: " + disease
    			 + "\n key: " + key);

		byte[] llaveSimDecr = SecurityUtils.decryptSymmetricKey(SecurityUtils.getPrKey(PrivateKey), pacientId);

		nuevoTexto = SecurityUtils.decryptDataWithSymmetricKey(disease, llaveSimDecr);

		System.out.println("Texto final: " + nuevoTexto);
		
    	}catch(Exception e){
			e.printStackTrace();
		}
    	
    	DummyClass dc = new DummyClass(pacientId, 1, ("Texto final: " + nuevoTexto).getBytes());
        return dc;
    }
}